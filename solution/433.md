# 433. 最小基因变化

[题目链接](https://leetcode.cn/problems/minimum-genetic-mutation/description)

## 解法一：BFS

### 思路

- 每个基因能变化成哪些基因等价于图上节点有哪些连边
  - 连边的判断：只有一个字母有差异
- 可以先预处理出整个图
- 需要加 visited 防止有环

### 代码

```py
class Solution:
    def minMutation(self, startGene: str, endGene: str, bank: List[str]) -> int:
        if startGene == endGene:
            return 0

        def diffone(s, t):
            return sum(x != y for x, y in zip(s, t)) == 1

        n = len(bank)
        g = [[] for _ in range(n)]
        end_idx = -1
        for i, s in enumerate(bank):
            if s == endGene:
                end_idx = i
            for j in range(i + 1, n):
                if diffone(s, bank[j]):
                    g[i].append(j)
                    g[j].append(i)
        
        visited = set([i for i, s in enumerate(bank) if diffone(startGene, s)])
        q = [(i, 1) for i in visited]

        while q:
            idx, step = q.pop(0)
            if idx == end_idx:
                return step
            
            for next_idx in g[idx]:
                if next_idx not in visited:
                    visited.add(idx)
                    q.append((next_idx, step + 1))

        return -1
```

### 复杂度

- 时间：O(m * n^2)
- 空间：O(n^2)
